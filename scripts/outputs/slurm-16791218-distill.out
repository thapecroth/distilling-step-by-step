#!/bin/bash -l
#SBATCH --job-name=distill
#SBATCH --partition=gpu-a40
#SBATCH --account=balazinska
#SBATCH --nodes=1
#SBATCH --cpus-per-task=8
#SBATCH --gres=gpu:1
#SBATCH --mem=100G
#SBATCH --time=10:00:00
#SBATCH --output="/gscratch/balazinska/enhaoz/distilling-step-by-step/scripts/outputs/slurm-%j-%x.out"

cat $0
echo "Date" $(date)
echo "--------------------"

dataset=$1

echo "dataset: $dataset"

cd /gscratch/balazinska/enhaoz/distilling-step-by-step
bash /gscratch/balazinska/enhaoz/distilling-step-by-step/scripts/apptainer-script.sh \
    python run.py --from_pretrained google/t5-v1_1-base --dataset $dataset --model_type task_prefix --label_type gt --llm palm --alpha 0.5 --batch_size 64 --lora_train
Date Fri Mar 1 10:45:03 PST 2024
--------------------
dataset: svamp
INFO:    Warning: Mounting unchecked fs, running e2fsck is recommended.
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Map:   0%|          | 0/720 [00:00<?, ? examples/s]/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:3892: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
Map: 100%|██████████| 720/720 [00:00<00:00, 5320.88 examples/s]Map: 100%|██████████| 720/720 [00:00<00:00, 5151.01 examples/s]
Map:   0%|          | 0/80 [00:00<?, ? examples/s]Map: 100%|██████████| 80/80 [00:00<00:00, 6026.95 examples/s]
Map:   0%|          | 0/200 [00:00<?, ? examples/s]Map: 100%|██████████| 200/200 [00:00<00:00, 6302.63 examples/s]
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
trainable params: 884,736 || all params: 248,462,592 || trainable%: 0.3560841867092814
  0%|          | 0/10000 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/10000 [00:03<9:34:50,  3.45s/it]  0%|          | 2/10000 [00:04<5:14:46,  1.89s/it]  0%|          | 3/10000 [00:05<3:52:16,  1.39s/it]  0%|          | 4/10000 [00:05<3:12:32,  1.16s/it]  0%|          | 5/10000 [00:06<2:50:00,  1.02s/it]  0%|          | 6/10000 [00:07<2:39:49,  1.04it/s]  0%|          | 7/10000 [00:08<2:31:48,  1.10it/s]  0%|          | 8/10000 [00:09<2:25:00,  1.15it/s]  0%|          | 9/10000 [00:09<2:23:11,  1.16it/s]  0%|          | 10/10000 [00:10<2:21:59,  1.17it/s]  0%|          | 11/10000 [00:11<2:22:31,  1.17it/s]  0%|          | 12/10000 [00:11<1:52:14,  1.48it/s]  0%|          | 13/10000 [00:12<1:58:30,  1.40it/s]  0%|          | 14/10000 [00:13<2:04:27,  1.34it/s]  0%|          | 15/10000 [00:14<2:08:38,  1.29it/s]  0%|          | 16/10000 [00:15<2:10:53,  1.27it/s]  0%|          | 17/10000 [00:15<2:11:38,  1.26it/s]  0%|          | 18/10000 [00:16<2:13:56,  1.24it/s]  0%|          | 19/10000 [00:17<2:15:53,  1.22it/s]  0%|          | 20/10000 [00:18<2:14:41,  1.23it/s]  0%|          | 21/10000 [00:19<2:14:31,  1.24it/s]  0%|          | 22/10000 [00:20<2:17:58,  1.21it/s]  0%|          | 23/10000 [00:20<2:17:14,  1.21it/s]  0%|          | 24/10000 [00:21<1:48:07,  1.54it/s]  0%|          | 25/10000 [00:21<1:56:07,  1.43it/s]  0%|          | 26/10000 [00:22<2:02:53,  1.35it/s]  0%|          | 27/10000 [00:23<2:06:54,  1.31it/s]  0%|          | 28/10000 [00:24<2:08:20,  1.29it/s]  0%|          | 29/10000 [00:25<2:11:36,  1.26it/s]  0%|          | 30/10000 [00:26<2:14:30,  1.24it/s]  0%|          | 31/10000 [00:26<2:15:52,  1.22it/s]  0%|          | 32/10000 [00:27<2:14:13,  1.24it/s]  0%|          | 33/10000 [00:28<2:12:33,  1.25it/s]  0%|          | 34/10000 [00:29<2:15:48,  1.22it/s]  0%|          | 35/10000 [00:30<2:16:22,  1.22it/s]  0%|          | 36/10000 [00:30<1:46:38,  1.56it/s]  0%|          | 37/10000 [00:31<1:57:57,  1.41it/s]  0%|          | 38/10000 [00:32<2:01:49,  1.36it/s]  0%|          | 39/10000 [00:32<2:08:33,  1.29it/s]  0%|          | 40/10000 [00:33<2:10:02,  1.28it/s]  0%|          | 41/10000 [00:34<2:11:09,  1.27it/s]  0%|          | 42/10000 [00:35<2:13:46,  1.24it/s]  0%|          | 43/10000 [00:36<2:14:59,  1.23it/s]  0%|          | 44/10000 [00:36<2:12:14,  1.25it/s]  0%|          | 45/10000 [00:37<2:12:01,  1.26it/s]  0%|          | 46/10000 [00:38<2:13:43,  1.24it/s]  0%|          | 47/10000 [00:39<2:12:47,  1.25it/s]  0%|          | 48/10000 [00:39<1:43:37,  1.60it/s]  0%|          | 49/10000 [00:40<1:53:51,  1.46it/s]  0%|          | 50/10000 [00:41<1:58:57,  1.39it/s]  1%|          | 51/10000 [00:42<2:02:57,  1.35it/s]  1%|          | 52/10000 [00:42<2:06:02,  1.32it/s]  1%|          | 53/10000 [00:43<2:08:37,  1.29it/s]  1%|          | 54/10000 [00:44<2:12:56,  1.25it/s]  1%|          | 55/10000 [00:45<2:14:17,  1.23it/s]  1%|          | 56/10000 [00:46<2:15:35,  1.22it/s]  1%|          | 57/10000 [00:46<2:14:11,  1.23it/s]  1%|          | 58/10000 [00:47<2:17:53,  1.20it/s]  1%|          | 59/10000 [00:48<2:18:52,  1.19it/s]  1%|          | 60/10000 [00:48<1:51:26,  1.49it/s]  1%|          | 61/10000 [00:49<1:58:32,  1.40it/s]  1%|          | 62/10000 [00:50<2:01:33,  1.36it/s]  1%|          | 63/10000 [00:51<2:08:01,  1.29it/s]  1%|          | 64/10000 [00:52<2:11:36,  1.26it/s]  1%|          | 65/10000 [00:53<2:15:15,  1.22it/s]  1%|          | 66/10000 [00:54<2:18:00,  1.20it/s]  1%|          | 67/10000 [00:54<2:17:12,  1.21it/s]  1%|          | 68/10000 [00:55<2:16:03,  1.22it/s]  1%|          | 69/10000 [00:56<2:16:08,  1.22it/s]  1%|          | 70/10000 [00:57<2:10:29,  1.27it/s]  1%|          | 71/10000 [00:58<2:12:10,  1.25it/s]  1%|          | 72/10000 [00:58<1:42:18,  1.62it/s]  1%|          | 73/10000 [00:59<1:52:36,  1.47it/s]  1%|          | 74/10000 [00:59<1:53:19,  1.46it/s]  1%|          | 75/10000 [01:00<1:57:38,  1.41it/s]  1%|          | 76/10000 [01:01<2:02:36,  1.35it/s]  1%|          | 77/10000 [01:02<2:06:10,  1.31it/s]  1%|          | 78/10000 [01:02<2:10:55,  1.26it/s]  1%|          | 79/10000 [01:03<2:15:29,  1.22it/s]  1%|          | 80/10000 [01:04<2:16:16,  1.21it/s]  1%|          | 81/10000 [01:05<2:16:24,  1.21it/s]  1%|          | 82/10000 [01:06<2:13:46,  1.24it/s]  1%|          | 83/10000 [01:07<2:13:37,  1.24it/s]  1%|          | 84/10000 [01:07<1:45:38,  1.56it/s]  1%|          | 85/10000 [01:08<1:57:19,  1.41it/s]  1%|          | 86/10000 [01:09<2:01:11,  1.36it/s]  1%|          | 87/10000 [01:09<2:05:01,  1.32it/s]  1%|          | 88/10000 [01:10<2:09:45,  1.27it/s]  1%|          | 89/10000 [01:11<2:11:36,  1.26it/s]  1%|          | 90/10000 [01:12<2:12:54,  1.24it/s]  1%|          | 91/10000 [01:13<2:13:31,  1.24it/s]  1%|          | 92/10000 [01:13<2:14:58,  1.22it/s]  1%|          | 93/10000 [01:14<2:14:21,  1.23it/s]  1%|          | 94/10000 [01:15<2:11:42,  1.25it/s]  1%|          | 95/10000 [01:16<2:12:13,  1.25it/s]  1%|          | 96/10000 [01:16<1:43:57,  1.59it/s]  1%|          | 97/10000 [01:17<1:53:00,  1.46it/s]  1%|          | 98/10000 [01:18<1:58:10,  1.40it/s]  1%|          | 99/10000 [01:19<2:03:09,  1.34it/s]  1%|          | 100/10000 [01:19<2:06:50,  1.30it/s]  1%|          | 101/10000 [01:20<2:09:34,  1.27it/s]  1%|          | 102/10000 [01:21<2:13:16,  1.24it/s]  1%|          | 103/10000 [01:22<2:15:19,  1.22it/s]  1%|          | 104/10000 [01:23<2:14:33,  1.23it/s]  1%|          | 105/10000 [01:24<2:17:28,  1.20it/s]  1%|          | 106/10000 [01:24<2:18:10,  1.19it/s]  1%|          | 107/10000 [01:25<2:14:26,  1.23it/s]  1%|          | 108/10000 [01:25<1:44:25,  1.58it/s]  1%|          | 109/10000 [01:26<1:54:03,  1.45it/s]  1%|          | 110/10000 [01:27<1:59:11,  1.38it/s]  1%|          | 111/10000 [01:28<2:04:21,  1.33it/s]  1%|          | 112/10000 [01:29<2:08:47,  1.28it/s]  1%|          | 113/10000 [01:29<2:10:36,  1.26it/s]  1%|          | 114/10000 [01:30<2:07:19,  1.29it/s]  1%|          | 115/10000 [01:31<2:05:12,  1.32it/s]  1%|          | 116/10000 [01:32<2:09:35,  1.27it/s]  1%|          | 117/10000 [01:33<2:13:46,  1.23it/s]  1%|          | 118/10000 [01:33<2:14:47,  1.22it/s]  1%|          | 119/10000 [01:34<2:15:52,  1.21it/s]  1%|          | 120/10000 [01:35<1:46:47,  1.54it/s]  1%|          | 121/10000 [01:35<1:57:17,  1.40it/s]  1%|          | 122/10000 [01:36<2:03:26,  1.33it/s]  1%|          | 123/10000 [01:37<2:05:54,  1.31it/s]  1%|          | 124/10000 [01:38<2:06:19,  1.30it/s]  1%|▏         | 125/10000 [01:39<2:08:44,  1.28it/s]  1%|▏         | 126/10000 [01:39<2:10:11,  1.26it/s]  1%|▏         | 127/10000 [01:40<2:08:33,  1.28it/s]  1%|▏         | 128/10000 [01:41<2:13:18,  1.23it/s]  1%|▏         | 129/10000 [01:42<2:12:22,  1.24it/s]  1%|▏         | 130/10000 [01:43<2:15:21,  1.22it/s]  1%|▏         | 131/10000 [01:44<2:14:08,  1.23it/s]  1%|▏         | 132/10000 [01:44<1:43:46,  1.58it/s]  1%|▏         | 133/10000 [01:45<1:53:54,  1.44it/s]  1%|▏         | 134/10000 [01:45<1:59:40,  1.37it/s]  1%|▏         | 135/10000 [01:46<2:05:19,  1.31it/s]  1%|▏         | 136/10000 [01:47<2:05:05,  1.31it/s]  1%|▏         | 137/10000 [01:48<2:08:24,  1.28it/s]  1%|▏         | 138/10000 [01:49<2:11:44,  1.25it/s]  1%|▏         | 139/10000 [01:50<2:14:38,  1.22it/s]  1%|▏         | 140/10000 [01:50<2:14:16,  1.22it/s]  1%|▏         | 141/10000 [01:51<2:15:34,  1.21it/s]  1%|▏         | 142/10000 [01:52<2:15:18,  1.21it/s]  1%|▏         | 143/10000 [01:53<2:14:23,  1.22it/s]  1%|▏         | 144/10000 [01:53<1:45:34,  1.56it/s]  1%|▏         | 145/10000 [01:54<1:54:12,  1.44it/s]  1%|▏         | 146/10000 [01:55<1:59:24,  1.38it/s]  1%|▏         | 147/10000 [01:55<2:03:57,  1.32it/s]  1%|▏         | 148/10000 [01:56<2:08:20,  1.28it/s]  1%|▏         | 149/10000 [01:57<2:10:44,  1.26it/s]  2%|▏         | 150/10000 [01:58<2:12:57,  1.23it/s]  2%|▏         | 151/10000 [01:59<2:15:39,  1.21it/s]  2%|▏         | 152/10000 [02:00<2:14:09,  1.22it/s]  2%|▏         | 153/10000 [02:01<2:15:52,  1.21it/s]  2%|▏         | 154/10000 [02:01<2:16:13,  1.20it/s]  2%|▏         | 155/10000 [02:02<2:16:12,  1.20it/s]  2%|▏         | 156/10000 [02:02<1:45:46,  1.55it/s]  2%|▏         | 157/10000 [02:03<1:57:52,  1.39it/s]  2%|▏         | 158/10000 [02:04<2:02:36,  1.34it/s]  2%|▏         | 159/10000 [02:05<2:06:10,  1.30it/s]  2%|▏         | 160/10000 [02:06<2:07:36,  1.29it/s]  2%|▏         | 161/10000 [02:07<2:10:51,  1.25it/s]  2%|▏         | 162/10000 [02:07<2:13:07,  1.23it/s]  2%|▏         | 163/10000 [02:08<2:12:25,  1.24it/s]  2%|▏         | 164/10000 [02:09<2:10:04,  1.26it/s]  2%|▏         | 165/10000 [02:10<2:09:05,  1.27it/s]  2%|▏         | 166/10000 [02:11<2:09:41,  1.26it/s]  2%|▏         | 167/10000 [02:11<2:11:47,  1.24it/s]  2%|▏         | 168/10000 [02:12<1:41:56,  1.61it/s]  2%|▏         | 169/10000 [02:12<1:48:40,  1.51it/s]  2%|▏         | 170/10000 [02:13<1:57:51,  1.39it/s]  2%|▏         | 171/10000 [02:14<2:02:45,  1.33it/s]  2%|▏         | 172/10000 [02:15<2:06:42,  1.29it/s]  2%|▏         | 173/10000 [02:16<2:08:44,  1.27it/s]  2%|▏         | 174/10000 [02:16<2:10:12,  1.26it/s]  2%|▏         | 175/10000 [02:17<2:08:35,  1.27it/s]  2%|▏         | 176/10000 [02:18<2:12:38,  1.23it/s]  2%|▏         | 177/10000 [02:19<2:12:26,  1.24it/s]  2%|▏         | 178/10000 [02:20<2:15:27,  1.21it/s]  2%|▏         | 179/10000 [02:21<2:15:59,  1.20it/s]  2%|▏         | 180/10000 [02:21<1:44:45,  1.56it/s]  2%|▏         | 181/10000 [02:22<1:54:27,  1.43it/s]  2%|▏         | 182/10000 [02:22<1:55:44,  1.41it/s]  2%|▏         | 183/10000 [02:23<2:02:18,  1.34it/s]  2%|▏         | 184/10000 [02:24<2:08:40,  1.27it/s]  2%|▏         | 185/10000 [02:25<2:09:47,  1.26it/s]  2%|▏         | 186/10000 [02:26<2:12:02,  1.24it/s]  2%|▏         | 187/10000 [02:27<2:09:50,  1.26it/s]  2%|▏         | 188/10000 [02:27<2:10:58,  1.25it/s]  2%|▏         | 189/10000 [02:28<2:12:11,  1.24it/s]  2%|▏         | 190/10000 [02:29<2:14:02,  1.22it/s]  2%|▏         | 191/10000 [02:30<2:12:07,  1.24it/s]  2%|▏         | 192/10000 [02:30<1:43:50,  1.57it/s]  2%|▏         | 193/10000 [02:31<1:55:10,  1.42it/s]  2%|▏         | 194/10000 [02:32<2:03:26,  1.32it/s]  2%|▏         | 195/10000 [02:33<2:07:32,  1.28it/s]  2%|▏         | 196/10000 [02:33<2:08:22,  1.27it/s]  2%|▏         | 197/10000 [02:34<2:07:56,  1.28it/s]  2%|▏         | 198/10000 [02:35<2:08:21,  1.27it/s]  2%|▏         | 199/10000 [02:36<2:07:42,  1.28it/s]  2%|▏         | 200/10000 [02:37<2:11:14,  1.24it/s]  2%|▏         | 201/10000 [02:37<2:09:35,  1.26it/s]  2%|▏         | 202/10000 [02:38<2:11:54,  1.24it/s]  2%|▏         | 203/10000 [02:39<2:11:59,  1.24it/s]  2%|▏         | 204/10000 [02:39<1:44:39,  1.56it/s]  2%|▏         | 205/10000 [02:40<1:54:17,  1.43it/s]  2%|▏         | 206/10000 [02:41<1:59:27,  1.37it/s]  2%|▏         | 207/10000 [02:42<2:02:34,  1.33it/s]  2%|▏         | 208/10000 [02:43<2:08:34,  1.27it/s]  2%|▏         | 209/10000 [02:43<2:11:39,  1.24it/s]  2%|▏         | 210/10000 [02:44<2:14:14,  1.22it/s]  2%|▏         | 211/10000 [02:45<2:15:37,  1.20it/s]  2%|▏         | 212/10000 [02:46<2:16:09,  1.20it/s]  2%|▏         | 213/10000 [02:47<2:14:58,  1.21it/s]  2%|▏         | 214/10000 [02:48<2:13:49,  1.22it/s]  2%|▏         | 215/10000 [02:48<2:13:18,  1.22it/s]  2%|▏         | 216/10000 [02:49<1:44:34,  1.56it/s]  2%|▏         | 217/10000 [02:49<1:53:54,  1.43it/s]  2%|▏         | 218/10000 [02:50<2:02:29,  1.33it/s]  2%|▏         | 219/10000 [02:51<2:06:58,  1.28it/s]  2%|▏         | 220/10000 [02:52<2:07:28,  1.28it/s]  2%|▏         | 221/10000 [02:53<2:04:44,  1.31it/s]  2%|▏         | 222/10000 [02:54<2:08:27,  1.27it/s]  2%|▏         | 223/10000 [02:54<2:08:50,  1.26it/s]  2%|▏         | 224/10000 [02:55<2:09:36,  1.26it/s]  2%|▏         | 225/10000 [02:56<2:09:35,  1.26it/s]  2%|▏         | 226/10000 [02:57<2:12:09,  1.23it/s]  2%|▏         | 227/10000 [02:58<2:11:42,  1.24it/s]  2%|▏         | 228/10000 [02:58<1:43:36,  1.57it/s]  2%|▏         | 229/10000 [02:59<1:56:15,  1.40it/s]  2%|▏         | 230/10000 [02:59<2:00:02,  1.36it/s]  2%|▏         | 231/10000 [03:00<2:04:15,  1.31it/s]  2%|▏         | 232/10000 [03:01<2:06:28,  1.29it/s]  2%|▏         | 233/10000 [03:02<2:06:35,  1.29it/s]  2%|▏         | 234/10000 [03:03<2:08:23,  1.27it/s]  2%|▏         | 235/10000 [03:04<2:10:12,  1.25it/s]  2%|▏         | 236/10000 [03:04<2:13:21,  1.22it/s]  2%|▏         | 237/10000 [03:05<2:10:36,  1.25it/s]  2%|▏         | 238/10000 [03:06<2:09:32,  1.26it/s]  2%|▏         | 239/10000 [03:07<2:10:37,  1.25it/s]  2%|▏         | 240/10000 [03:07<1:42:37,  1.59it/s]  2%|▏         | 241/10000 [03:08<1:55:07,  1.41it/s]  2%|▏         | 242/10000 [03:09<1:59:50,  1.36it/s]  2%|▏         | 243/10000 [03:10<2:04:26,  1.31it/s]  2%|▏         | 244/10000 [03:10<2:08:06,  1.27it/s]  2%|▏         | 245/10000 [03:11<2:10:14,  1.25it/s]  2%|▏         | 246/10000 [03:12<2:11:21,  1.24it/s]  2%|▏         | 247/10000 [03:13<2:07:48,  1.27it/s]  2%|▏         | 248/10000 [03:14<2:11:08,  1.24it/s]  2%|▏         | 249/10000 [03:14<2:07:46,  1.27it/s]  2%|▎         | 250/10000 [03:15<2:10:36,  1.24it/s]                                                       2%|▎         | 250/10000 [03:15<2:10:36,  1.24it/s]{'loss': 13.4567, 'grad_norm': 330.4102478027344, 'learning_rate': 4.875e-05, 'epoch': 20.83}

  0%|          | 0/4 [00:00<?, ?it/s][A
 50%|█████     | 2/4 [00:01<00:01,  1.58it/s][A
 75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s][A
100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A                                                     
                                             [A  2%|▎         | 250/10000 [03:21<2:10:36,  1.24it/s]
100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
                                             [A  3%|▎         | 251/10000 [03:22<6:45:37,  2.50s/it]  3%|▎         | 252/10000 [03:22<4:55:24,  1.82s/it]  3%|▎         | 253/10000 [03:23<4:08:43,  1.53s/it]  3%|▎         | 254/10000 [03:24<3:34:58,  1.32s/it]  3%|▎         | 255/10000 [03:24<3:07:30,  1.15s/it]  3%|▎         | 256/10000 [03:25<2:52:44,  1.06s/it]  3%|▎         | 257/10000 [03:26<2:41:55,  1.00it/s]  3%|▎         | 258/10000 [03:27<2:28:40,  1.09it/s]  3%|▎         | 259/10000 [03:28<2:24:53,  1.12it/s]  3%|▎         | 260/10000 [03:28<2:19:31,  1.16it/s]  3%|▎         | 261/10000 [03:29<2:18:31,  1.17it/s]  3%|▎         | 262/10000 [03:30<2:15:31,  1.20it/s]  3%|▎         | 263/10000 [03:31<2:15:02,  1.20it/s]  3%|▎         | 264/10000 [03:31<1:44:35,  1.55it/s]  3%|▎         | 265/10000 [03:32<1:52:09,  1.45it/s]  3%|▎         | 266/10000 [03:33<1:59:43,  1.36it/s]  3%|▎         | 267/10000 [03:34<2:04:20,  1.30it/s]  3%|▎         | 268/10000 [03:34<2:08:17,  1.26it/s]  3%|▎         | 269/10000 [03:35<2:12:09,  1.23it/s]  3%|▎         | 270/10000 [03:36<2:14:14,  1.21it/s]  3%|▎         | 271/10000 [03:37<2:12:55,  1.22it/s]  3%|▎         | 272/10000 [03:38<2:12:48,  1.22it/s]  3%|▎         | 273/10000 [03:38<2:10:13,  1.24it/s]  3%|▎         | 274/10000 [03:39<2:09:37,  1.25it/s]  3%|▎         | 275/10000 [03:40<2:07:17,  1.27it/s]  3%|▎         | 276/10000 [03:40<1:40:13,  1.62it/s]  3%|▎         | 277/10000 [03:41<1:49:23,  1.48it/s]  3%|▎         | 278/10000 [03:42<1:57:45,  1.38it/s]  3%|▎         | 279/10000 [03:43<2:03:59,  1.31it/s]  3%|▎         | 280/10000 [03:44<2:06:52,  1.28it/s]  3%|▎         | 281/10000 [03:44<2:08:25,  1.26it/s]  3%|▎         | 282/10000 [03:45<2:10:28,  1.24it/s]  3%|▎         | 283/10000 [03:46<2:11:55,  1.23it/s]  3%|▎         | 284/10000 [03:47<2:11:04,  1.24it/s]  3%|▎         | 285/10000 [03:48<2:07:01,  1.27it/s]  3%|▎         | 286/10000 [03:48<2:10:44,  1.24it/s]  3%|▎         | 287/10000 [03:49<2:10:44,  1.24it/s]  3%|▎         | 288/10000 [03:49<1:42:17,  1.58it/s]  3%|▎         | 289/10000 [03:50<1:53:05,  1.43it/s]  3%|▎         | 290/10000 [03:51<1:55:55,  1.40it/s]  3%|▎         | 291/10000 [03:52<1:59:06,  1.36it/s]  3%|▎         | 292/10000 [03:53<2:03:10,  1.31it/s]  3%|▎         | 293/10000 [03:54<2:04:41,  1.30it/s]  3%|▎         | 294/10000 [03:54<2:05:01,  1.29it/s]  3%|▎         | 295/10000 [03:55<2:07:15,  1.27it/s]  3%|▎         | 296/10000 [03:56<2:06:10,  1.28it/s]  3%|▎         | 297/10000 [03:57<2:10:25,  1.24it/s]  3%|▎         | 298/10000 [03:58<2:10:34,  1.24it/s]  3%|▎         | 299/10000 [03:58<2:13:36,  1.21it/s]  3%|▎         | 300/10000 [03:59<1:44:57,  1.54it/s]  3%|▎         | 301/10000 [04:00<1:55:46,  1.40it/s]  3%|▎         | 302/10000 [04:00<1:54:40,  1.41it/s]  3%|▎         | 303/10000 [04:01<1:59:46,  1.35it/s]  3%|▎         | 304/10000 [04:02<2:04:54,  1.29it/s]  3%|▎         | 305/10000 [04:03<2:07:34,  1.27it/s]  3%|▎         | 306/10000 [04:04<2:09:07,  1.25it/s]  3%|▎         | 307/10000 [04:04<2:11:05,  1.23it/s]  3%|▎         | 308/10000 [04:05<2:11:35,  1.23it/s]  3%|▎         | 309/10000 [04:06<2:11:04,  1.23it/s]  3%|▎         | 310/10000 [04:07<2:10:48,  1.23it/s]  3%|▎         | 311/10000 [04:08<2:12:23,  1.22it/s]  3%|▎         | 312/10000 [04:08<1:42:27,  1.58it/s]  3%|▎         | 313/10000 [04:09<1:51:47,  1.44it/s]  3%|▎         | 314/10000 [04:09<1:57:41,  1.37it/s]  3%|▎         | 315/10000 [04:10<2:03:35,  1.31it/s]  3%|▎         | 316/10000 [04:11<2:05:27,  1.29it/s]  3%|▎         | 317/10000 [04:12<2:07:23,  1.27it/s]  3%|▎         | 318/10000 [04:13<2:08:01,  1.26it/s]  3%|▎         | 319/10000 [04:14<2:09:51,  1.24it/s]  3%|▎         | 320/10000 [04:14<2:12:35,  1.22it/s]  3%|▎         | 321/10000 [04:15<2:11:28,  1.23it/s]  3%|▎         | 322/10000 [04:16<2:12:42,  1.22it/s]  3%|▎         | 323/10000 [04:17<2:13:34,  1.21it/s]  3%|▎         | 324/10000 [04:17<1:45:04,  1.53it/s]  3%|▎         | 325/10000 [04:18<1:53:48,  1.42it/s]  3%|▎         | 326/10000 [04:19<1:59:38,  1.35it/s]  3%|▎         | 327/10000 [04:20<2:01:45,  1.32it/s]  3%|▎         | 328/10000 [04:20<2:02:00,  1.32it/s]  3%|▎         | 329/10000 [04:21<2:05:55,  1.28it/s]  3%|▎         | 330/10000 [04:22<2:10:33,  1.23it/s]  3%|▎         | 331/10000 [04:23<2:11:57,  1.22it/s]  3%|▎         | 332/10000 [04:24<2:13:24,  1.21it/s]  3%|▎         | 333/10000 [04:25<2:15:26,  1.19it/s]  3%|▎         | 334/10000 [04:26<2:15:26,  1.19it/s]  3%|▎         | 335/10000 [04:26<2:10:55,  1.23it/s]  3%|▎         | 336/10000 [04:26<1:41:37,  1.58it/s]  3%|▎         | 337/10000 [04:27<1:49:27,  1.47it/s]  3%|▎         | 338/10000 [04:28<1:52:43,  1.43it/s]  3%|▎         | 339/10000 [04:29<1:59:47,  1.34it/s]  3%|▎         | 340/10000 [04:30<2:03:48,  1.30it/s]  3%|▎         | 341/10000 [04:30<2:06:21,  1.27it/s]  3%|▎         | 342/10000 [04:31<2:10:34,  1.23it/s]  3%|▎         | 343/10000 [04:32<2:13:30,  1.21it/s]  3%|▎         | 344/10000 [04:33<2:10:12,  1.24it/s]  3%|▎         | 345/10000 [04:34<2:11:30,  1.22it/s]  3%|▎         | 346/10000 [04:35<2:13:42,  1.20it/s]  3%|▎         | 347/10000 [04:35<2:12:17,  1.22it/s]  3%|▎         | 348/10000 [04:36<1:42:48,  1.56it/s]  3%|▎         | 349/10000 [04:37<1:51:13,  1.45it/s]  4%|▎         | 350/10000 [04:37<1:57:15,  1.37it/s]  4%|▎         | 351/10000 [04:38<2:03:05,  1.31it/s]  4%|▎         | 352/10000 [04:39<2:05:36,  1.28it/s]  4%|▎         | 353/10000 [04:40<2:03:47,  1.30it/s]  4%|▎         | 354/10000 [04:41<2:04:59,  1.29it/s]  4%|▎         | 355/10000 [04:41<2:07:38,  1.26it/s]  4%|▎         | 356/10000 [04:42<2:07:57,  1.26it/s]  4%|▎         | 357/10000 [04:43<2:08:20,  1.25it/s]  4%|▎         | 358/10000 [04:44<2:12:07,  1.22it/s]  4%|▎         | 359/10000 [04:45<2:11:34,  1.22it/s]  4%|▎         | 360/10000 [04:45<1:43:02,  1.56it/s]  4%|▎         | 361/10000 [04:46<1:52:52,  1.42it/s]  4%|▎         | 362/10000 [04:47<1:57:16,  1.37it/s]  4%|▎         | 363/10000 [04:47<2:02:33,  1.31it/s]  4%|▎         | 364/10000 [04:48<2:00:52,  1.33it/s]  4%|▎         | 365/10000 [04:49<2:05:02,  1.28it/s]  4%|▎         | 366/10000 [04:50<2:08:23,  1.25it/s]  4%|▎         | 367/10000 [04:51<2:09:29,  1.24it/s]  4%|▎         | 368/10000 [04:51<2:07:55,  1.25it/s]  4%|▎         | 369/10000 [04:52<2:11:45,  1.22it/s]  4%|▎         | 370/10000 [04:53<2:12:35,  1.21it/s]  4%|▎         | 371/10000 [04:54<2:11:46,  1.22it/s]  4%|▎         | 372/10000 [04:54<1:42:30,  1.57it/s]  4%|▎         | 373/10000 [04:55<1:53:09,  1.42it/s]  4%|▎         | 374/10000 [04:56<2:00:07,  1.34it/s]  4%|▍         | 375/10000 [04:57<2:04:12,  1.29it/s]  4%|▍         | 376/10000 [04:57<2:04:34,  1.29it/s]  4%|▍         | 377/10000 [04:58<2:07:18,  1.26it/s]  4%|▍         | 378/10000 [04:59<2:10:38,  1.23it/s]  4%|▍         | 379/10000 [05:00<2:09:33,  1.24it/s]  4%|▍         | 380/10000 [05:01<2:11:00,  1.22it/s]  4%|▍         | 381/10000 [05:02<2:06:55,  1.26it/s]  4%|▍         | 382/10000 [05:02<2:08:15,  1.25it/s]  4%|▍         | 383/10000 [05:03<2:04:43,  1.29it/s]  4%|▍         | 384/10000 [05:03<1:37:45,  1.64it/s]  4%|▍         | 385/10000 [05:04<1:45:53,  1.51it/s]  4%|▍         | 386/10000 [05:05<1:54:04,  1.40it/s]  4%|▍         | 387/10000 [05:06<1:59:18,  1.34it/s]  4%|▍         | 388/10000 [05:07<2:03:53,  1.29it/s]  4%|▍         | 389/10000 [05:07<2:07:36,  1.26it/s]  4%|▍         | 390/10000 [05:08<2:08:31,  1.25it/s]  4%|▍         | 391/10000 [05:09<2:10:44,  1.22it/s]  4%|▍         | 392/10000 [05:10<2:09:08,  1.24it/s]  4%|▍         | 393/10000 [05:11<2:09:17,  1.24it/s]  4%|▍         | 394/10000 [05:11<2:07:54,  1.25it/s]  4%|▍         | 395/10000 [05:12<2:10:07,  1.23it/s]  4%|▍         | 396/10000 [05:12<1:40:49,  1.59it/s]  4%|▍         | 397/10000 [05:13<1:50:10,  1.45it/s]  4%|▍         | 398/10000 [05:14<1:51:42,  1.43it/s]  4%|▍         | 399/10000 [05:15<1:58:32,  1.35it/s]  4%|▍         | 400/10000 [05:16<2:02:29,  1.31it/s]  4%|▍         | 401/10000 [05:17<2:05:05,  1.28it/s]  4%|▍         | 402/10000 [05:17<2:06:16,  1.27it/s]  4%|▍         | 403/10000 [05:18<2:04:05,  1.29it/s]  4%|▍         | 404/10000 [05:19<2:07:34,  1.25it/s]  4%|▍         | 405/10000 [05:20<2:05:30,  1.27it/s]  4%|▍         | 406/10000 [05:21<2:08:33,  1.24it/s]  4%|▍         | 407/10000 [05:21<2:08:02,  1.25it/s]  4%|▍         | 408/10000 [05:22<1:41:06,  1.58it/s]  4%|▍         | 409/10000 [05:22<1:51:10,  1.44it/s]  4%|▍         | 410/10000 [05:23<1:56:39,  1.37it/s]  4%|▍         | 411/10000 [05:24<2:01:45,  1.31it/s]  4%|▍         | 412/10000 [05:25<2:03:24,  1.29it/s]  4%|▍         | 413/10000 [05:26<2:08:50,  1.24it/s]  4%|▍         | 414/10000 [05:27<2:10:00,  1.23it/s]  4%|▍         | 415/10000 [05:27<2:11:25,  1.22it/s]  4%|▍         | 416/10000 [05:28<2:10:40,  1.22it/s]  4%|▍         | 417/10000 [05:29<2:07:10,  1.26it/s]  4%|▍         | 418/10000 [05:30<2:09:04,  1.24it/s]  4%|▍         | 419/10000 [05:31<2:10:35,  1.22it/s]  4%|▍         | 420/10000 [05:31<1:41:31,  1.57it/s]  4%|▍         | 421/10000 [05:32<1:51:02,  1.44it/s]  4%|▍         | 422/10000 [05:33<1:59:08,  1.34it/s]  4%|▍         | 423/10000 [05:33<2:05:51,  1.27it/s]  4%|▍         | 424/10000 [05:34<2:08:23,  1.24it/s]  4%|▍         | 425/10000 [05:35<2:09:59,  1.23it/s]  4%|▍         | 426/10000 [05:36<2:10:05,  1.23it/s]  4%|▍         | 427/10000 [05:37<2:11:52,  1.21it/s]  4%|▍         | 428/10000 [05:38<2:11:50,  1.21it/s]  4%|▍         | 429/10000 [05:38<2:10:00,  1.23it/s]  4%|▍         | 430/10000 [05:39<2:09:39,  1.23it/s]  4%|▍         | 431/10000 [05:40<2:08:55,  1.24it/s]  4%|▍         | 432/10000 [05:40<1:41:35,  1.57it/s]  4%|▍         | 433/10000 [05:41<1:51:57,  1.42it/s]  4%|▍         | 434/10000 [05:42<1:58:42,  1.34it/s]  4%|▍         | 435/10000 [05:43<2:03:03,  1.30it/s]  4%|▍         | 436/10000 [05:44<2:06:21,  1.26it/s]  4%|▍         | 437/10000 [05:44<2:09:53,  1.23it/s]  4%|▍         | 438/10000 [05:45<2:08:44,  1.24it/s]  4%|▍         | 439/10000 [05:46<2:09:05,  1.23it/s]  4%|▍         | 440/10000 [05:47<2:07:56,  1.25it/s]  4%|▍         | 441/10000 [05:48<2:07:00,  1.25it/s]  4%|▍         | 442/10000 [05:48<2:04:06,  1.28it/s]  4%|▍         | 443/10000 [05:49<2:08:39,  1.24it/s]  4%|▍         | 444/10000 [05:49<1:40:07,  1.59it/s]  4%|▍         | 445/10000 [05:50<1:49:54,  1.45it/s]  4%|▍         | 446/10000 [05:51<1:54:45,  1.39it/s]  4%|▍         | 447/10000 [05:52<1:59:19,  1.33it/s]  4%|▍         | 448/10000 [05:53<2:04:10,  1.28it/s]  4%|▍         | 449/10000 [05:54<2:06:53,  1.25it/s]  4%|▍         | 450/10000 [05:54<2:06:22,  1.26it/s]  5%|▍         | 451/10000 [05:55<2:07:27,  1.25it/s]  5%|▍         | 452/10000 [05:56<2:07:22,  1.25it/s]  5%|▍         | 453/10000 [05:57<2:09:47,  1.23it/s]  5%|▍         | 454/10000 [05:58<2:09:51,  1.23it/s]  5%|▍         | 455/10000 [05:59<2:10:16,  1.22it/s]  5%|▍         | 456/10000 [05:59<1:41:44,  1.56it/s]  5%|▍         | 457/10000 [06:00<1:51:25,  1.43it/s]  5%|▍         | 458/10000 [06:00<1:57:09,  1.36it/s]  5%|▍         | 459/10000 [06:01<1:59:44,  1.33it/s]  5%|▍         | 460/10000 [06:02<2:02:11,  1.30it/s]  5%|▍         | 461/10000 [06:03<2:07:09,  1.25it/s]  5%|▍         | 462/10000 [06:04<2:05:53,  1.26it/s]  5%|▍         | 463/10000 [06:04<2:07:10,  1.25it/s]  5%|▍         | 464/10000 [06:05<2:07:03,  1.25it/s]  5%|▍         | 465/10000 [06:06<2:09:29,  1.23it/s]  5%|▍         | 466/10000 [06:07<2:12:21,  1.20it/s]  5%|▍         | 467/10000 [06:08<2:08:39,  1.23it/s]  5%|▍         | 468/10000 [06:08<1:40:15,  1.58it/s]  5%|▍         | 469/10000 [06:09<1:49:39,  1.45it/s]  5%|▍         | 470/10000 [06:10<1:54:58,  1.38it/s]  5%|▍         | 471/10000 [06:10<1:55:37,  1.37it/s]  5%|▍         | 472/10000 [06:11<2:00:04,  1.32it/s]  5%|▍         | 473/10000 [06:12<2:02:57,  1.29it/s]  5%|▍         | 474/10000 [06:13<2:05:44,  1.26it/s]  5%|▍         | 475/10000 [06:14<2:07:51,  1.24it/s]  5%|▍         | 476/10000 [06:15<2:11:38,  1.21it/s]  5%|▍         | 477/10000 [06:15<2:11:01,  1.21it/s]  5%|▍         | 478/10000 [06:16<2:09:07,  1.23it/s]  5%|▍         | 479/10000 [06:17<2:09:54,  1.22it/s]  5%|▍         | 480/10000 [06:17<1:40:54,  1.57it/s]  5%|▍         | 481/10000 [06:18<1:45:01,  1.51it/s]  5%|▍         | 482/10000 [06:19<1:50:42,  1.43it/s]  5%|▍         | 483/10000 [06:19<1:56:08,  1.37it/s]  5%|▍         | 484/10000 [06:20<2:00:13,  1.32it/s]  5%|▍         | 485/10000 [06:21<2:03:52,  1.28it/s]  5%|▍         | 486/10000 [06:22<2:06:48,  1.25it/s]  5%|▍         | 487/10000 [06:23<2:07:25,  1.24it/s]  5%|▍         | 488/10000 [06:24<2:08:36,  1.23it/s]  5%|▍         | 489/10000 [06:24<2:09:24,  1.23it/s]  5%|▍         | 490/10000 [06:25<2:11:42,  1.20it/s]  5%|▍         | 491/10000 [06:26<2:10:54,  1.21it/s]  5%|▍         | 492/10000 [06:26<1:42:00,  1.55it/s]  5%|▍         | 493/10000 [06:27<1:51:46,  1.42it/s]  5%|▍         | 494/10000 [06:28<1:56:20,  1.36it/s]  5%|▍         | 495/10000 [06:29<2:01:44,  1.30it/s]  5%|▍         | 496/10000 [06:30<2:03:25,  1.28it/s]  5%|▍         | 497/10000 [06:30<2:02:50,  1.29it/s]  5%|▍         | 498/10000 [06:31<2:00:08,  1.32it/s]  5%|▍         | 499/10000 [06:32<2:04:19,  1.27it/s]  5%|▌         | 500/10000 [06:33<2:07:49,  1.24it/s]                                                       5%|▌         | 500/10000 [06:33<2:07:49,  1.24it/s]{'eval_test_loss': 7.019043922424316, 'eval_test_accuracy': 0.0, 'eval_test_runtime': 5.5914, 'eval_test_samples_per_second': 35.769, 'eval_test_steps_per_second': 0.715, 'epoch': 20.83}
{'loss': 5.7195, 'grad_norm': 47.7015266418457, 'learning_rate': 4.75e-05, 'epoch': 41.67}

  0%|          | 0/4 [00:00<?, ?it/s][A
 50%|█████     | 2/4 [00:01<00:01,  1.56it/s][A
 75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s][A
100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A                                                     
                                             [A  5%|▌         | 500/10000 [06:38<2:07:49,  1.24it/s]
100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
                                             [A  5%|▌         | 501/10000 [06:39<6:03:43,  2.30s/it]  5%|▌         | 502/10000 [06:39<4:51:46,  1.84s/it]  5%|▌         | 503/10000 [06:40<4:02:14,  1.53s/it]  5%|▌         | 504/10000 [06:40<2:59:58,  1.14s/it]  5%|▌         | 505/10000 [06:41<2:46:08,  1.05s/it]  5%|▌         | 506/10000 [06:42<2:34:00,  1.03it/s]  5%|▌         | 507/10000 [06:43<2:28:52,  1.06it/s]  5%|▌         | 508/10000 [06:44<2:24:12,  1.10it/s]  5%|▌         | 509/10000 [06:45<2:19:02,  1.14it/s]  5%|▌         | 510/10000 [06:45<2:14:45,  1.17it/s]  5%|▌         | 511/10000 [06:46<2:15:37,  1.17it/s]  5%|▌         | 512/10000 [06:47<2:14:35,  1.17it/s]  5%|▌         | 513/10000 [06:48<2:14:16,  1.18it/s]  5%|▌         | 514/10000 [06:49<2:12:27,  1.19it/s]  5%|▌         | 515/10000 [06:50<2:11:53,  1.20it/s]  5%|▌         | 516/10000 [06:50<1:41:57,  1.55it/s]  5%|▌         | 517/10000 [06:51<1:48:56,  1.45it/s]  5%|▌         | 518/10000 [06:51<1:55:24,  1.37it/s]  5%|▌         | 519/10000 [06:52<1:58:42,  1.33it/s]  5%|▌         | 520/10000 [06:53<2:03:47,  1.28it/s]  5%|▌         | 521/10000 [06:54<2:04:53,  1.26it/s]  5%|▌         | 522/10000 [06:55<2:07:49,  1.24it/s]  5%|▌         | 523/10000 [06:55<2:08:02,  1.23it/s]  5%|▌         | 524/10000 [06:56<2:11:17,  1.20it/s]  5%|▌         | 525/10000 [06:57<2:07:14,  1.24it/s]  5%|▌         | 526/10000 [06:58<2:08:03,  1.23it/s]  5%|▌         | 527/10000 [06:59<2:09:07,  1.22it/s]  5%|▌         | 528/10000 [06:59<1:40:27,  1.57it/s]  5%|▌         | 529/10000 [07:00<1:51:08,  1.42it/s]  5%|▌         | 530/10000 [07:01<1:53:43,  1.39it/s]  5%|▌         | 531/10000 [07:01<1:59:07,  1.32it/s]  5%|▌         | 532/10000 [07:02<2:02:57,  1.28it/s]  5%|▌         | 533/10000 [07:03<2:03:27,  1.28it/s]  5%|▌         | 534/10000 [07:04<2:02:54,  1.28it/s]  5%|▌         | 535/10000 [07:05<2:05:35,  1.26it/s]  5%|▌         | 536/10000 [07:05<2:04:03,  1.27it/s]  5%|▌         | 537/10000 [07:06<2:05:41,  1.25it/s]  5%|▌         | 538/10000 [07:07<2:02:52,  1.28it/s]  5%|▌         | 539/10000 [07:08<2:05:39,  1.25it/s]  5%|▌         | 540/10000 [07:08<1:38:34,  1.60it/s]  5%|▌         | 541/10000 [07:09<1:46:46,  1.48it/s]  5%|▌         | 542/10000 [07:10<1:51:21,  1.42it/s]  5%|▌         | 543/10000 [07:10<1:57:28,  1.34it/s]  5%|▌         | 544/10000 [07:11<2:02:21,  1.29it/s]  5%|▌         | 545/10000 [07:12<2:04:23,  1.27it/s]  5%|▌         | 546/10000 [07:13<2:06:39,  1.24it/s]  5%|▌         | 547/10000 [07:14<2:07:23,  1.24it/s]  5%|▌         | 548/10000 [07:15<2:08:42,  1.22it/s]  5%|▌         | 549/10000 [07:15<2:08:42,  1.22it/s]  6%|▌         | 550/10000 [07:16<2:06:45,  1.24it/s]  6%|▌         | 551/10000 [07:17<2:09:29,  1.22it/s]  6%|▌         | 552/10000 [07:17<1:41:39,  1.55it/s]  6%|▌         | 553/10000 [07:18<1:49:40,  1.44it/s]  6%|▌         | 554/10000 [07:19<1:55:19,  1.37it/s]  6%|▌         | 555/10000 [07:20<1:57:51,  1.34it/s]  6%|▌         | 556/10000 [07:21<1:59:54,  1.31it/s]  6%|▌         | 557/10000 [07:21<2:03:53,  1.27it/s]  6%|▌         | 558/10000 [07:22<2:03:46,  1.27it/s]  6%|▌         | 559/10000 [07:23<2:06:38,  1.24it/s]  6%|▌         | 560/10000 [07:24<2:04:11,  1.27it/s]  6%|▌         | 561/10000 [07:25<2:07:51,  1.23it/s]  6%|▌         | 562/10000 [07:25<2:07:41,  1.23it/s]  6%|▌         | 563/10000 [07:26<2:08:47,  1.22it/s]  6%|▌         | 564/10000 [07:27<1:46:30,  1.48it/s]  6%|▌         | 565/10000 [07:27<1:54:50,  1.37it/s]  6%|▌         | 566/10000 [07:28<2:01:19,  1.30it/s]  6%|▌         | 567/10000 [07:29<1:59:37,  1.31it/s]  6%|▌         | 568/10000 [07:30<2:02:47,  1.28it/s]  6%|▌         | 569/10000 [07:31<2:01:42,  1.29it/s]  6%|▌         | 570/10000 [07:32<2:04:35,  1.26it/s]  6%|▌         | 571/10000 [07:32<2:05:30,  1.25it/s]  6%|▌         | 572/10000 [07:33<2:05:51,  1.25it/s]  6%|▌         | 573/10000 [07:34<2:06:11,  1.25it/s]  6%|▌         | 574/10000 [07:35<2:08:14,  1.23it/s]  6%|▌         | 575/10000 [07:36<2:09:51,  1.21it/s]  6%|▌         | 576/10000 [07:36<1:40:34,  1.56it/s]  6%|▌         | 577/10000 [07:37<1:45:30,  1.49it/s]  6%|▌         | 578/10000 [07:37<1:53:29,  1.38it/s]  6%|▌         | 579/10000 [07:38<1:58:56,  1.32it/s]  6%|▌         | 580/10000 [07:39<2:01:22,  1.29it/s]  6%|▌         | 581/10000 [07:40<2:04:35,  1.26it/s]  6%|▌         | 582/10000 [07:41<2:08:41,  1.22it/s]  6%|▌         | 583/10000 [07:42<2:09:21,  1.21it/s]  6%|▌         | 584/10000 [07:42<2:07:41,  1.23it/s]  6%|▌         | 585/10000 [07:43<2:09:02,  1.22it/s]  6%|▌         | 586/10000 [07:44<2:05:15,  1.25it/s]  6%|▌         | 587/10000 [07:45<2:03:59,  1.27it/s]  6%|▌         | 588/10000 [07:45<1:38:25,  1.59it/s]  6%|▌         | 589/10000 [07:46<1:43:28,  1.52it/s]  6%|▌         | 590/10000 [07:47<1:51:37,  1.41it/s]  6%|▌         | 591/10000 [07:47<1:57:10,  1.34it/s]  6%|▌         | 592/10000 [07:48<2:00:30,  1.30it/s]  6%|▌         | 593/10000 [07:49<2:03:15,  1.27it/s]  6%|▌         | 594/10000 [07:50<2:04:13,  1.26it/s]  6%|▌         | 595/10000 [07:51<2:07:08,  1.23it/s]  6%|▌         | 596/10000 [07:52<2:08:08,  1.22it/s]  6%|▌         | 597/10000 [07:52<2:09:27,  1.21it/s]  6%|▌         | 598/10000 [07:53<2:09:26,  1.21it/s]  6%|▌         | 599/10000 [07:54<2:08:57,  1.21it/s]  6%|▌         | 600/10000 [07:54<1:41:00,  1.55it/s]  6%|▌         | 601/10000 [07:55<1:46:25,  1.47it/s]  6%|▌         | 602/10000 [07:56<1:55:40,  1.35it/s]  6%|▌         | 603/10000 [07:57<1:59:35,  1.31it/s]  6%|▌         | 604/10000 [07:58<2:01:53,  1.28it/s]  6%|▌         | 605/10000 [07:58<2:05:48,  1.24it/s]  6%|▌         | 606/10000 [07:59<2:04:38,  1.26it/s]  6%|▌         | 607/10000 [08:00<2:06:37,  1.24it/s]  6%|▌         | 608/10000 [08:01<2:09:12,  1.21it/s]  6%|▌         | 609/10000 [08:02<2:08:34,  1.22it/s]  6%|▌         | 610/10000 [08:03<2:09:13,  1.21it/s]  6%|▌         | 611/10000 [08:03<2:07:12,  1.23it/s]  6%|▌         | 612/10000 [08:04<1:38:24,  1.59it/s]  6%|▌         | 613/10000 [08:04<1:45:55,  1.48it/s]  6%|▌         | 614/10000 [08:05<1:54:14,  1.37it/s]  6%|▌         | 615/10000 [08:06<1:53:33,  1.38it/s]  6%|▌         | 616/10000 [08:07<2:00:05,  1.30it/s]  6%|▌         | 617/10000 [08:08<2:03:21,  1.27it/s]  6%|▌         | 618/10000 [08:08<2:04:30,  1.26it/s]  6%|▌         | 619/10000 [08:09<2:05:21,  1.25it/s]  6%|▌         | 620/10000 [08:10<2:05:11,  1.25it/s]  6%|▌         | 621/10000 [08:11<2:06:45,  1.23it/s]  6%|▌         | 622/10000 [08:12<2:09:03,  1.21it/s]  6%|▌         | 623/10000 [08:13<2:07:57,  1.22it/s]  6%|▌         | 624/10000 [08:13<1:39:02,  1.58it/s]  6%|▋         | 625/10000 [08:14<1:51:14,  1.40it/s]  6%|▋         | 626/10000 [08:14<1:53:32,  1.38it/s]  6%|▋         | 627/10000 [08:15<1:59:12,  1.31it/s]  6%|▋         | 628/10000 [08:16<2:01:01,  1.29it/s]  6%|▋         | 629/10000 [08:17<2:03:48,  1.26it/s]  6%|▋         | 630/10000 [08:18<2:05:36,  1.24it/s]  6%|▋         | 631/10000 [08:19<2:07:41,  1.22it/s]  6%|▋         | 632/10000 [08:19<2:06:24,  1.24it/s]  6%|▋         | 633/10000 [08:20<2:08:53,  1.21it/s]  6%|▋         | 634/10000 [08:21<2:09:02,  1.21it/s]  6%|▋         | 635/10000 [08:22<2:08:01,  1.22it/s]  6%|▋         | 636/10000 [08:22<1:40:33,  1.55it/s]  6%|▋         | 637/10000 [08:23<1:52:04,  1.39it/s]  6%|▋         | 638/10000 [08:24<1:57:49,  1.32it/s]  6%|▋         | 639/10000 [08:25<2:01:38,  1.28it/s]  6%|▋         | 640/10000 [08:25<2:03:51,  1.26it/s]  6%|▋         | 641/10000 [08:26<2:07:03,  1.23it/s]  6%|▋         | 642/10000 [08:27<2:08:44,  1.21it/s]  6%|▋         | 643/10000 [08:28<2:08:30,  1.21it/s]  6%|▋         | 644/10000 [08:29<2:08:23,  1.21it/s]  6%|▋         | 645/10000 [08:30<2:07:38,  1.22it/s]  6%|▋         | 646/10000 [08:30<2:08:24,  1.21it/s]  6%|▋         | 647/10000 [08:31<2:06:01,  1.24it/s]  6%|▋         | 648/10000 [08:31<1:38:55,  1.58it/s]  6%|▋         | 649/10000 [08:32<1:48:16,  1.44it/s]  6%|▋         | 650/10000 [08:33<1:55:30,  1.35it/s]  7%|▋         | 651/10000 [08:34<1:58:24,  1.32it/s]  7%|▋         | 652/10000 [08:35<2:00:30,  1.29it/s]  7%|▋         | 653/10000 [08:36<2:03:56,  1.26it/s]  7%|▋         | 654/10000 [08:36<2:07:33,  1.22it/s]  7%|▋         | 655/10000 [08:37<2:08:18,  1.21it/s]  7%|▋         | 656/10000 [08:38<2:09:41,  1.20it/s]  7%|▋         | 657/10000 [08:39<2:04:24,  1.25it/s]  7%|▋         | 658/10000 [08:40<2:03:24,  1.26it/s]  7%|▋         | 659/10000 [08:40<2:05:06,  1.24it/s]  7%|▋         | 660/10000 [08:41<1:37:24,  1.60it/s]  7%|▋         | 661/10000 [08:42<1:47:02,  1.45it/s]  7%|▋         | 662/10000 [08:42<1:52:40,  1.38it/s]  7%|▋         | 663/10000 [08:43<1:56:11,  1.34it/s]  7%|▋         | 664/10000 [08:44<1:59:31,  1.30it/s]  7%|▋         | 665/10000 [08:45<2:03:18,  1.26it/s]  7%|▋         | 666/10000 [08:46<2:04:17,  1.25it/s]  7%|▋         | 667/10000 [08:46<2:06:23,  1.23it/s]  7%|▋         | 668/10000 [08:47<2:07:44,  1.22it/s]  7%|▋         | 669/10000 [08:48<2:09:39,  1.20it/s]  7%|▋         | 670/10000 [08:49<2:09:50,  1.20it/s]  7%|▋         | 671/10000 [08:50<2:09:50,  1.20it/s]  7%|▋         | 672/10000 [08:50<1:40:00,  1.55it/s]  7%|▋         | 673/10000 [08:51<1:51:22,  1.40it/s]  7%|▋         | 674/10000 [08:52<1:54:50,  1.35it/s]  7%|▋         | 675/10000 [08:52<1:56:55,  1.33it/s]  7%|▋         | 676/10000 [08:53<1:57:25,  1.32it/s]  7%|▋         | 677/10000 [08:54<1:59:02,  1.31it/s]  7%|▋         | 678/10000 [08:55<2:02:09,  1.27it/s]  7%|▋         | 679/10000 [08:56<2:04:28,  1.25it/s]  7%|▋         | 680/10000 [08:57<2:06:20,  1.23it/s]  7%|▋         | 681/10000 [08:57<2:07:42,  1.22it/s]  7%|▋         | 682/10000 [08:58<2:03:16,  1.26it/s]  7%|▋         | 683/10000 [08:59<2:05:08,  1.24it/s]  7%|▋         | 684/10000 [08:59<1:38:00,  1.58it/s]  7%|▋         | 685/10000 [09:00<1:47:29,  1.44it/s]  7%|▋         | 686/10000 [09:01<1:53:38,  1.37it/s]  7%|▋         | 687/10000 [09:02<1:59:45,  1.30it/s]  7%|▋         | 688/10000 [09:03<2:02:47,  1.26it/s]  7%|▋         | 689/10000 [09:03<2:02:30,  1.27it/s]  7%|▋         | 690/10000 [09:04<2:02:33,  1.27it/s]  7%|▋         | 691/10000 [09:05<2:05:06,  1.24it/s]  7%|▋         | 692/10000 [09:06<2:06:14,  1.23it/s]  7%|▋         | 693/10000 [09:07<2:03:59,  1.25it/s]  7%|▋         | 694/10000 [09:07<2:06:46,  1.22it/s]  7%|▋         | 695/10000 [09:08<2:01:56,  1.27it/s]  7%|▋         | 696/10000 [09:08<1:36:56,  1.60it/s]  7%|▋         | 697/10000 [09:09<1:46:58,  1.45it/s]  7%|▋         | 698/10000 [09:10<1:53:55,  1.36it/s]  7%|▋         | 699/10000 [09:11<1:55:37,  1.34it/s]  7%|▋         | 700/10000 [09:12<1:57:39,  1.32it/s]  7%|▋         | 701/10000 [09:12<2:01:40,  1.27it/s]  7%|▋         | 702/10000 [09:13<2:04:31,  1.24it/s]  7%|▋         | 703/10000 [09:14<2:07:22,  1.22it/s]  7%|▋         | 704/10000 [09:15<2:06:34,  1.22it/s]  7%|▋         | 705/10000 [09:16<2:08:52,  1.20it/s]  7%|▋         | 706/10000 [09:17<2:08:10,  1.21it/s]  7%|▋         | 707/10000 [09:18<2:09:14,  1.20it/s]  7%|▋         | 708/10000 [09:18<1:40:50,  1.54it/s]  7%|▋         | 709/10000 [09:19<1:50:32,  1.40it/s]  7%|▋         | 710/10000 [09:19<1:56:13,  1.33it/s]  7%|▋         | 711/10000 [09:20<2:01:50,  1.27it/s]  7%|▋         | 712/10000 [09:21<2:00:20,  1.29it/s]  7%|▋         | 713/10000 [09:22<2:01:50,  1.27it/s]  7%|▋         | 714/10000 [09:23<2:03:16,  1.26it/s]  7%|▋         | 715/10000 [09:24<2:06:11,  1.23it/s]  7%|▋         | 716/10000 [09:24<2:08:05,  1.21it/s]  7%|▋         | 717/10000 [09:25<2:05:15,  1.24it/s]  7%|▋         | 718/10000 [09:26<2:06:08,  1.23it/s]  7%|▋         | 719/10000 [09:27<2:06:04,  1.23it/s]  7%|▋         | 720/10000 [09:27<1:38:23,  1.57it/s]  7%|▋         | 721/10000 [09:28<1:44:34,  1.48it/s]  7%|▋         | 722/10000 [09:29<1:49:05,  1.42it/s]  7%|▋         | 723/10000 [09:29<1:52:44,  1.37it/s]  7%|▋         | 724/10000 [09:30<1:57:53,  1.31it/s]  7%|▋         | 725/10000 [09:31<1:58:14,  1.31it/s]  7%|▋         | 726/10000 [09:32<2:00:36,  1.28it/s]  7%|▋         | 727/10000 [09:33<2:03:24,  1.25it/s]  7%|▋         | 728/10000 [09:33<2:04:14,  1.24it/s]  7%|▋         | 729/10000 [09:34<2:03:31,  1.25it/s]  7%|▋         | 730/10000 [09:35<2:05:14,  1.23it/s]  7%|▋         | 731/10000 [09:36<2:06:54,  1.22it/s]  7%|▋         | 732/10000 [09:36<1:39:46,  1.55it/s]  7%|▋         | 733/10000 [09:37<1:49:50,  1.41it/s]  7%|▋         | 734/10000 [09:38<1:54:22,  1.35it/s]  7%|▋         | 735/10000 [09:39<1:56:47,  1.32it/s]  7%|▋         | 736/10000 [09:40<2:02:35,  1.26it/s]  7%|▋         | 737/10000 [09:40<2:04:35,  1.24it/s]  7%|▋         | 738/10000 [09:41<2:06:19,  1.22it/s]  7%|▋         | 739/10000 [09:42<2:03:44,  1.25it/s]  7%|▋         | 740/10000 [09:43<2:05:35,  1.23it/s]  7%|▋         | 741/10000 [09:44<2:08:08,  1.20it/s]  7%|▋         | 742/10000 [09:45<2:08:28,  1.20it/s]  7%|▋         | 743/10000 [09:45<2:06:29,  1.22it/s]  7%|▋         | 744/10000 [09:46<1:38:53,  1.56it/s]  7%|▋         | 745/10000 [09:46<1:47:48,  1.43it/s]  7%|▋         | 746/10000 [09:47<1:55:29,  1.34it/s]  7%|▋         | 747/10000 [09:48<1:58:12,  1.30it/s]  7%|▋         | 748/10000 [09:49<2:01:40,  1.27it/s]  7%|▋         | 749/10000 [09:50<2:03:37,  1.25it/s]  8%|▊         | 750/10000 [09:51<2:07:02,  1.21it/s]                                                       8%|▊         | 750/10000 [09:51<2:07:02,  1.21it/s]{'eval_test_loss': 4.477128028869629, 'eval_test_accuracy': 0.0, 'eval_test_runtime': 4.9818, 'eval_test_samples_per_second': 40.146, 'eval_test_steps_per_second': 0.803, 'epoch': 41.67}
{'loss': 3.7615, 'grad_norm': 5.211085796356201, 'learning_rate': 4.6250000000000006e-05, 'epoch': 62.5}

  0%|          | 0/4 [00:00<?, ?it/s][A
 50%|█████     | 2/4 [00:01<00:01,  1.56it/s][A
 75%|███████▌  | 3/4 [00:02<00:00,  1.09it/s][ATraceback (most recent call last):
  File "/mmfs1/gscratch/balazinska/enhaoz/distilling-step-by-step/run.py", line 232, in <module>
    run(args)
  File "/mmfs1/gscratch/balazinska/enhaoz/distilling-step-by-step/run.py", line 200, in run
    lora_train_and_evaluate(args, args.run, tokenizer, tokenized_datasets, compute_metrics)
  File "/mmfs1/gscratch/balazinska/enhaoz/distilling-step-by-step/train_utils.py", line 198, in lora_train_and_evaluate
    trainer.train()
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 1624, in train
    return inner_training_loop(
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 2029, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 2412, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer_seq2seq.py", line 166, in evaluate
    return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 3211, in evaluate
    dataset_metrics = self.evaluate(
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer_seq2seq.py", line 166, in evaluate
    return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 3229, in evaluate
    output = eval_loop(
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/trainer.py", line 3520, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "/mmfs1/gscratch/balazinska/enhaoz/distilling-step-by-step/metrics.py", line 74, in compute_metrics
    decoded_preds = tokenizer.batch_decode(predictions[0], skip_special_tokens=True)
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3742, in batch_decode
    return [
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3743, in <listcomp>
    self.decode(
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3782, in decode
    return self._decode(
  File "/gscratch/balazinska/enhaoz/distill/lib/python3.10/site-packages/transformers/tokenization_utils_fast.py", line 625, in _decode
    text = self._tokenizer.decode(token_ids, skip_special_tokens=skip_special_tokens)
OverflowError: out of range integral type conversion attempted
  8%|▊         | 750/10000 [09:55<2:02:21,  1.26it/s]

                                             [A